CREATE TABLE IF NOT EXISTS amazon_ads_sp_search_term (
    amazon_ads_sp_search_term_id int(11) NOT NULL,
    select_date_id int(11) DEFAULT NULL,
    time_unit_id int(11) DEFAULT NULL,
    user_id int(11) DEFAULT NULL,
    profile_id VARCHAR(50) DEFAULT NULL,
    portfolio_id VARCHAR(50) DEFAULT NULL,
    campaign_id VARCHAR(50) DEFAULT NULL,
    ad_group_id VARCHAR(50) DEFAULT NULL,

    keyword_id VARCHAR(50) NOT NULL DEFAULT 1,
    target_id VARCHAR(50) NOT NULL DEFAULT 1,

    date date DEFAULT NULL,
    start_date date DEFAULT NULL,
    end_date date DEFAULT NULL,

    campaign_name varchar(255) DEFAULT NULL,
    ad_group_name varchar(255) DEFAULT NULL,
    keyword varchar(255) DEFAULT NULL,
    impressions int(11) DEFAULT NULL,
    clicks int(11) DEFAULT NULL,
    cost_per_click decimal(8,4) DEFAULT NULL,
    click_through_rate decimal(10,6) DEFAULT NULL,
    cost decimal(8,4) DEFAULT NULL,
    purchases1d int(11) DEFAULT NULL,
    purchases7d int(11) DEFAULT NULL,
    purchases14d int(11) DEFAULT NULL,
    purchases30d int(11) DEFAULT NULL,
    purchases_same_sku1d int(11) DEFAULT NULL,
    purchases_same_sku7d int(11) DEFAULT NULL,
    purchases_same_sku14d int(11) DEFAULT NULL,
    purchases_same_sku30d int(11) DEFAULT NULL,
    units_sold_clicks1d int(11) DEFAULT NULL,
    units_sold_clicks7d int(11) DEFAULT NULL,
    units_sold_clicks14d int(11) DEFAULT NULL,
    units_sold_clicks30d int(11) DEFAULT NULL,
    sales1d decimal(8,4) DEFAULT NULL,
    sales7d decimal(8,4) DEFAULT NULL,
    sales14d decimal(8,4) DEFAULT NULL,
    sales30d decimal(8,4) DEFAULT NULL,
    attributed_sales_same_sku1d double DEFAULT NULL,
    attributed_sales_same_sku7d double DEFAULT NULL,
    attributed_sales_same_sku14d double DEFAULT NULL,
    attributed_sales_same_sku30d double DEFAULT NULL,
    units_sold_same_sku1d int(11) DEFAULT NULL,
    units_sold_same_sku7d int(11) DEFAULT NULL,
    units_sold_same_sku14d int(11) DEFAULT NULL,
    units_sold_same_sku30d int(11) DEFAULT NULL,
    kindle_edition_normalized_pages_read14d int(11) DEFAULT NULL,
    kindle_edition_normalized_pages_royalties14d decimal(8,4) DEFAULT NULL,
    sales_other_sku7d int(11) DEFAULT NULL,
    units_sold_other_sku7d int(11) DEFAULT NULL,
    acos_clicks7d double DEFAULT NULL,
    acos_clicks14d double DEFAULT NULL,
    roas_clicks7d decimal(8,4) DEFAULT NULL,
    roas_clicks14d decimal(8,4) DEFAULT NULL,
    campaign_budget_currency_code varchar(255) DEFAULT NULL,
    search_term varchar(255) DEFAULT NULL,
    campaign_budget_type varchar(255) DEFAULT NULL,
    campaign_budget_amount decimal(8,4) DEFAULT NULL,
    campaign_status varchar(255) DEFAULT NULL,
    keyword_bid decimal(8,4) DEFAULT NULL,
    keyword_type varchar(255) DEFAULT NULL,
    match_type varchar(255) DEFAULT NULL,
    targeting varchar(255) DEFAULT NULL,
    ad_keyword_status varchar(255) DEFAULT NULL
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;

ALTER TABLE amazon_ads_sp_search_term
    ADD PRIMARY KEY (amazon_ads_sp_search_term_id),
    ADD KEY select_date_id(select_date_id),
    ADD KEY time_unit_id(time_unit_id),
    ADD KEY user_id(user_id),
    ADD KEY profile_id(profile_id),
    ADD KEY portfolio_id(portfolio_id),
    ADD KEY campaign_id(campaign_id),
    ADD KEY ad_group_id(ad_group_id),
    ADD KEY keyword_id(keyword_id),
    ADD KEY target_id(target_id),
    ADD UNIQUE KEY uniq(select_date_id,time_unit_id,user_id,profile_id,portfolio_id,campaign_id,ad_group_id,keyword_id,target_id,search_term);

ALTER TABLE amazon_ads_sp_search_term
    MODIFY amazon_ads_sp_search_term_id int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=1;

ALTER TABLE amazon_ads_sp_search_term
    ADD CONSTRAINT amazon_ads_sp_search_term_1 FOREIGN KEY (user_id) REFERENCES user (user_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_2 FOREIGN KEY (select_date_id) REFERENCES select_date (select_date_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_3 FOREIGN KEY (time_unit_id) REFERENCES time_unit (time_unit_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_4 FOREIGN KEY (profile_id) REFERENCES amazon_ads_profile (profile_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_5 FOREIGN KEY (portfolio_id) REFERENCES amazon_ads_portfolio (portfolio_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_6 FOREIGN KEY (campaign_id) REFERENCES amazon_ads_campaign (campaign_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_7 FOREIGN KEY (ad_group_id) REFERENCES amazon_ads_ad_group (ad_group_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_8 FOREIGN KEY (keyword_id) REFERENCES amazon_ads_keyword (keyword_id),
    ADD CONSTRAINT amazon_ads_sp_search_term_9 FOREIGN KEY (target_id) REFERENCES amazon_ads_target (target_id);